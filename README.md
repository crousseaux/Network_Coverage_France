Network Coverage by Providers in France
=======

## Installation Instructions

1. Clone the project.
    ```shell
    $ https://github.com/crousseaux/papernest.git
    ```
1. `cd` into the project directory
    ```shell
    $ cd Network_Coverage_France
    ```
1. Create a new virtual environment using Python 3.7 and activate it.
    ```shell
    $ python3 -m venv env
    $ source env/bin/activate
    ```
1. Install dependencies from requirements.txt:
    ```shell
    (env)$ pip install -r requirements.txt
    ```
1. Migrate the database.
    ```shell
    (env)$ python manage.py migrate
    ```
1. *(Optionally)* Populate the database with a handful of network coverage data by providers and by city in France

    **[Data Source](https://www.data.gouv.fr/s/resources/monreseaumobile/20180228-174515/2018_01_Sites_mobiles_2G_3G_4G_France_metropolitaine_L93.csv)**  
    ```shell
    (env)$ python manage.py populate_db
    ```
1. Run the local server via:
    ```shell
    (env)$ python manage.py runserver
    ```

### Done!
The browsable api will be available at <a href="http://localhost:8000/api" target="_blank">http://localhost:8000/api</a>

## Live Demo
[Test Environment](https://network-map-api.herokuapp.com/api/?q=Place%20G%C3%A9n%C3%A9ral%20Mellinet)

## Usage
#### [GET] Network coverage by provider in the city of a given address
**Query parameter:** q  
**Format:** you can use space or '+' in the address  
https://network-map-api.herokuapp.com/api/?q=Boulevard+Malesherbes  
https://network-map-api.herokuapp.com/api/?q=Boulevard%20Malesherbes  

#### [GET] City
All cities  
https://network-map-api.herokuapp.com/api/city/  
One city details  
https://network-map-api.herokuapp.com/api/city/1/  

#### [GET] Network Coverage
All networks coverage  
https://network-map-api.herokuapp.com/api/network/  
One network details  
https://network-map-api.herokuapp.com/api/network/1/  

#### [GET] Network Provider
All network providers  
https://network-map-api.herokuapp.com/api/provider/  
One network provider details  
https://network-map-api.herokuapp.com/api/provider/1/   

#### [GET] Network coverage by provider by city
All networks coverage by provider by city  
https://network-map-api.herokuapp.com/api/connector/  
One network coverage by provider by city  
https://network-map-api.herokuapp.com/api/connector/1/  

## Notes

1. `data/mcc_mnc_codes.csv` [Data Source](https://extranet.arcep.fr/portail/LinkClick.aspx?fileticket=etHdgos5yN4%3D&tabid=217&portalid=0&mid=850)  
1. `data/2018_01_Sites_mobiles_2G_3G_4G_France_metropolitaine_L93.csv` [Data Source](https://www.data.gouv.fr/s/resources/monreseaumobile/20180228-174515/2018_01_Sites_mobiles_2G_3G_4G_France_metropolitaine_L93.csv)  
1. `data_preprocessing.py`: script which pre-processes the first dataset and creates csv stored in the data folder. They will
then be used to populate the database.  
1. `data/cities.csv` csv generated by data_preprocessing.py using the second dataset. It lists all unique cities in the data source.
1. `data/networks.csv` csv generated by data_preprocessing.py using the second dataset. It lists all unique network coverage types in the data source.
1. `data/operators.csv` csv generated by data_preprocessing.py using the first two datasets. It lists all unique network providers in the data source.
1. `data/city_provider_network.csv` csv generated by data_preprocessing.py using the first two datasets. It lists all network coverage by provider by city from the data source.

## To do
1. Add unit tests: happy path and edge cases
1. Add integration test
1. Set up Django for production

## Further Improvements
1. If our original dataset is too big to compute on a single machine, we could use aws emr (elastic map reduce)  
1. Use postal codes instead of cities for more precision. Assuming two cities can have the same name, it would be useful to introduce postal codes.
1. A provider could provide a partial network coverage in the one city. In this case, we would introduce a new field on NetworkProviderCityConnector: 'partial'.
 It would essentially be a checkbox which indicates that a provider only covers parts of a city if checked and the full city if unchecked. Note: The record won't 
 exist if no coverage is available by the provider  
1. pyproj.transform is a deprecated method. We would change it to use the new transformer method.
1. Introduce typing to indicate the type of function parameters and return statement 
1. Add function docstrings  
1. Index city names to speed up API
